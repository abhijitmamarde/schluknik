#:import sys sys
#:import MapSource mapview.MapSource
#:import MapMarkerPopup mapview.MapMarkerPopup


## inheried classes

<MyBoxLayout@BoxLayout>:
    orientation: 'vertical'
    padding: 50,50,0,0
    spacing: 0

# header text
# todo: make text bubble
<HeaderLabel@Label>:
    color: 0,0,0,1
    text_size: root.width, None
    size: self.texture_size
    font_size: 25
    font_name: 'Roboto'
    halign: 'left'
    valign: 'middle'

# header image
<HeaderImage@Image>
	source: 'pics/app/icon.png'
	allow_stretch: True
    keep_ratio: True
    size_hint_y: 50
    size_hint_x: None

################################################################################################

# Screen for adding the drinks record

<DrinkScreen>:
    grid1: Grid1
    grid2: Grid2
    grid3: Grid3

    MyBoxLayout:	
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:

            HeaderLabel:
                text: '- Lets face it! You have been a schluknik again!'
		
        # Beer
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id1
                min: 0
                step: 0.5
                max: 10
                on_value: root.addbeer(slider_id1.value)
            Label:
                text:  str(round(slider_id1.value, 1)) + ' x Beers (500ml)'
                color: 0,0,0,1
        GridLayout:
            id: Grid1
            cols: 10
            rows: 1
					        
		# Wine
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 0.5
                max: 10
                on_value: root.addwine(slider_id2.value)
            Label:
                text:  str(round(slider_id2.value, 1)) + ' x Wine (200ml)'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 10
            rows: 1

        # Shots
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addshot(slider_id3.value)
            Label:
                text:  str(round(slider_id3.value, 1)) + ' x Shots (40ml)'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1

        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
					background_normal: str(False)
                    on_press: app.get_running_app().stop()
					background_down: 'pics/app/exit.png'
					Image:
						source: 'pics/app/exit.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
					background_normal: str(False)
					on_press: root.manager.current = 'setting'
					background_down: 'pics/app/settings.png'
					Image:
						source: 'pics/app/settings.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
                    background_normal: str(False)
                    on_press: root.manager.current = 'destroy'
					background_down: 'pics/app/next.png'
					Image:
						source: 'pics/app/next.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                    

################################################################################################
# Screen for adding the non-drinkable record
# todo: add food and stress

<DestroyScreen>:
    grid: Grid
	grid2: Grid2
	grid3: Grid3
	tiredranking: tiredranking
	stressranking: stressranking

    MyBoxLayout:
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'pics/app/icon.png'
            HeaderLabel:
                text: '- Yesterday evenings conditions?'

        # Cigarette slider
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id
                min: 0
                step: 1
                max: 30
                on_value: root.addcigarette(slider_id.value)
            Label:
                text: str(round(slider_id.value, 0)) + ' x cigarettes'
                color: 0,0,0,1
        GridLayout:
            id: Grid
            cols: 30
            rows: 1

		# Tired
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 1
                max: 10
                on_value: root.addtired(slider_id2.value)
            Label:
                id: tiredranking
                text: 'Energy'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 10
            rows: 1

		# Stress
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addstress(slider_id3.value)
            Label:
                id: stressranking
                text: 'Emotion'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1

                # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
					background_normal: str(False)
                    on_press: app.get_running_app().stop()
					background_down: 'pics/app/exit.png'
					Image:
						source: 'pics/app/exit.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
					background_normal: str(False)
					on_press: root.manager.current = 'setting'
					background_down: 'pics/app/settings.png'
					Image:
						source: 'pics/app/settings.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
                    background_normal: str(False)
                    on_press: root.manager.current = 'heal'
					background_down: 'pics/app/next.png'
					Image:
						source: 'pics/app/next.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False

################################################################################################
# Screen for adding the feeling better stuff

<HealScreen>:
    grid: Grid
    grid2: Grid2
    grid3: Grid3
    foodranking: foodranking

    MyBoxLayout:
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'pics/app/icon.png'
            HeaderLabel:
                text: '- Tried some countermeasures?'

        # water slider
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id1
                min: 0
                step: 1
                max: 5
                on_value: root.addwater(slider_id1.value)
            Label:
                text: str(round(slider_id1.value, 0)) + ' x glass of water'
                color: 0,0,0,1
        GridLayout:
            id: Grid
            cols: 30
            rows: 1


        # Sleep
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 0.5
                max: 12
                on_value: root.addsleep(slider_id2.value)
            Label:
                text: str(round(slider_id2.value, 1))+ ' hours of sleep'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 12
            rows: 1

        # Food
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addfood(slider_id3.value)
            Label:
                id: foodranking
                text: 'Food?'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1

                # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
					background_normal: str(False)
                    on_press: app.get_running_app().stop()
					background_down: 'pics/app/exit.png'
					Image:
						source: 'pics/app/exit.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
					background_normal: str(False)
					on_press: root.manager.current = 'setting'
					background_down: 'pics/app/settings.png'
					Image:
						source: 'pics/app/settings.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
                    background_normal: str(False)
                    on_press: root.manager.current = 'feel'
					background_down: 'pics/app/next.png'
					Image:
						source: 'pics/app/next.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False

################################################################################################
# Screen for adding current feeling stuff

<FeelScreen>:
    sleepy_grid: Sleepy_Grid
    headache_grid: Headache_Grid
    vomit_grid: Vomit_Grid

	sleepranking: sleepranking
	headacheranking: headacheranking
	vomitranking: vomitranking

    MyBoxLayout:
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'pics/app/icon.png'
            HeaderLabel:
                text: '- Yuck...And how do you feel now?'

        # sleep slider
        GridLayout:
            cols: 2
            rows: 1
			Label:
				id: sleepranking
				text: 'sleepy?'
				color: 0,0,0,1
            Slider:
                id: sleep
                min: 0
                step: 1
                max: 10
                on_value: root.addsleepy(sleep.value)  
        GridLayout:
            id: Sleepy_Grid
            cols: 30
            rows: 1
		
		# headache slider
        GridLayout:
            cols: 2
            rows: 1
			Label:
				id: headacheranking
				text: 'headache?'
				color: 0,0,0,1
            Slider:
                id: headache
                min: 0
                step: 1
                max: 10
                on_value: root.addheadache(headache.value)
        GridLayout:
            id: Headache_Grid
            cols: 30
            rows: 1

		# vomit slider
        GridLayout:
            cols: 2
            rows: 1
			Label:
				id: vomitranking
				text: 'vomit?'
				color: 0,0,0,1
            Slider:
                id: vomit
                min: 0
                step: 1
                max: 10
                on_value: root.addvomit(vomit.value)
        GridLayout:
            id: Vomit_Grid
            cols: 30
            rows: 1

        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
					background_normal: str(False)
                    on_press: app.get_running_app().stop()
					background_down: 'pics/app/exit.png'
					Image:
						source: 'pics/app/exit.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
					background_normal: str(False)
					on_press: root.manager.current = 'setting'
					background_down: 'pics/app/settings.png'
					Image:
						source: 'pics/app/settings.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False
                Button:
                    background_normal: str(False)
                    on_press: root.ftp_transfer()
					background_down: 'pics/app/next.png'
					Image:
						source: 'pics/app/next.png'
						y: self.parent.y + 10
						x: self.parent.x + 100
						size: 50,50
						allow_stretch: False

################################################################################################
# Navigation page for going to the presented results

<ResultScreen>:
	BoxLayout:
		orientation: 'vertical'
		padding: 200,0,200,50
		GridLayout:
			halign: 'center'
			valign: 'middle'
			cols: 2
			rows: 1
			HeaderImage:
				source: 'pics/app/icon.png'
			HeaderLabel:
				text: '- Lets check the results!'


		Button:
			halign: 'center'
			valign: 'middle'
			background_normal: str(False)
			on_press: root.manager.current = 'graph'
			background_down: 'pics/app/sine.png'
			Image:
				source: 'pics/app/sine.png'
				y: self.parent.y 
				x: self.parent.x 
				size: 200,200
				allow_stretch: False
                
		Button:
			halign: 'center'
			valign: 'middle'
			background_normal: str(False)
			on_press: root.manager.current = 'map'
			background_down: 'pics/app/map.png'
			Image:
				source: 'pics/app/map.png'
				y: self.parent.y 
				x: self.parent.x 
				size: 200,200
				allow_stretch: False
            
		
                
################################################################################################
# map of schlukniks

<MapScreen>:
    MapView:
        id: map
        lat: app.lat
        lon: app.lon
        zoom: 13
        map_source: MapSource(sys.argv[1], attribution="") if len(sys.argv) > 1 else "osm"

    # Navigation Bar
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        size_hint: .2, .2
        GridLayout:
            cols: 2
            rows: 1
            Button:
                text: '<'
                on_press: root.manager.current = 'result'
            Button:
                text: 'exit'
                on_press: app.get_running_app().stop()

################################################################################################
# settings page
# todo: add mandatory first time configuration -> stored as .json; smoker? size? weight? boy/girl?

<SettingsScreen>:
    MyBoxLayout:
		spacing: 30
		padding: 50,0,50,0
		GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'pics/app/icon.png'
            HeaderLabel:
                text: '-- Please tell us something about you!'
			
		GridLayout:
			cols: 2
			rows: 1
			ToggleButton:
				id: boy
				group: 'sex'
				on_press: root.boy(boy.state)
				background_normal: str(False)
				background_down: 'pics/app/man.png'
				Image:
					source:  'pics/app/man.png'
					y: self.parent.y + 10
					x: self.parent.x + 100
					size: 50,50
					allow_stretch: False
				
			ToggleButton:
				id: girl
				group: 'sex'
				on_press: root.girl(girl.state)
				background_normal: str(False)
				background_down: 'pics/app/woman.png'
				Image:
					source: 'pics/app/woman.png'
					y: self.parent.y + 10
					x: self.parent.x + 100
					size: 50,50
					allow_stretch: False

		GridLayout:
			cols: 2
			rows: 1
			ToggleButton:
				id: smoker
				group: 'smoker'
				on_press: root.smoker(smoker.state)
				background_normal: str(False)
				background_down: 'pics/app/smoke.png'
				Image:
					source:  'pics/app/smoke.png'
					y: self.parent.y + 10
					x: self.parent.x + 100
					size: 50,50
					allow_stretch: False

			ToggleButton:
				id: smoker
				group: 'smoker'
				on_press: root.smoker(smoker.state)
				background_normal: str(False)
				background_down: 'pics/app/nosmoke.png'
				Image:
					source:  'pics/app/nosmoke.png'
					y: self.parent.y + 10
					x: self.parent.x + 100
					size: 50,50
					allow_stretch: False
				
		GridLayout:
            cols: 3
            rows: 2
			GearTick:
				id: age
				zoom_factor: 2
				# uncomment the following to use non default values
				min: 18
				max: 99
				value: 18
				background_image: 'background.png'
				overlay_image: 'gear.png'
				on_value: root.age(age.value)
			GearTick:
				id: weight
				zoom_factor: 2
				# uncomment the following to use non default values
				min: 40
				max: 100
				value: 70
				#background_image: 'background.png'
				#overlay_image: 'gear.png'
			GearTick:
				id: high
				zoom_factor: 2
				# uncomment the following to use non default values
				min: 18
				max: 199
				value: 185
				#background_image: 'background.png'
				#overlay_image: 'gear.png'
			HeaderLabel:
				text: ('age: {} years').format(int(age.value))
			HeaderLabel:
				text: ('weight: {} kg').format(int(weight.value))
			HeaderLabel:
				text: ('height: {} cm').format(int(high.value))
			 
        AnchorLayout:
            anchor_x: 'left'
            anchor_y: 'bottom'
            BoxLayout:
                orientation: 'horizontal'
                size_hint: .3, .3
                Button:
                    on_press: root.storetojson()
					background_normal: str(False)
					background_down: 'pics/app/back.png'
					Image:
						source:  'pics/app/back.png'
						y: self.parent.y + 10
						x: self.parent.x + 10
						size: 50,50
						allow_stretch: False

################################################################################################
# hangover transient screen
# add meaningul computation depending on the input variables

<GraphScreen>:
    grid: Grid


	AnchorLayout:
		anchor_x: 'left'
		anchor_y: 'top'
		GridLayout:
			cols: 2
			rows: 1
			size_hint: .1, .1
			Button:
				text: '<'
				on_press: root.manager.current = 'result'
			Button:
				text: 'exit'
				on_press: app.get_running_app().stop()

	# graphs
	GridLayout:
		padding: 50,0,50,50
		spacing: 10
		size_hint: 1, 1
		id:Grid
		cols: 1
		rows: 5
		# Navigation Bar
		HeaderLabel:
			size_hint: .1, .1
			id: alki_score

		