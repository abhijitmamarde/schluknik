#:import sys sys
#:import MapSource mapview.MapSource
#:import MapMarkerPopup kivy.garden.mapview.MapMarkerPopup

## inheried classes

<MyBoxLayout@BoxLayout>:
    orientation: 'vertical'
    padding: 60,60,30,30
    spacing: 5

# header text
# todo: make text bubble
<HeaderLabel@Label>:
    color: 0,0,0,1
    text_size: root.width, None
    size: self.texture_size
    font_size: 35
    font_name: 'Roboto'
    halign: 'left'
    valign: 'middle'

# header image
<HeaderImage@Image>
    scale: 6.0

################################################################################################

# Screen for adding the drinks record
<DrinkScreen>:
    grid1: Grid1
    grid2: Grid2
    grid3: Grid3
    MyBoxLayout:
        AnchorLayout:
            anchor_x: 'right'
            anchor_y: 'top'
            BoxLayout:
                orientation: 'horizontal'
                size_hint: .3, .3
                Button:
                    text: 'Settings'
                    on_press: root.manager.current = 'setting'
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'icon.png'
            HeaderLabel:
                text: 'Lets face it! You have been a schluknik again!'

        # Beer
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id1
                min: 0
                step: 0.5
                max: 10
                on_value: root.addbeer(slider_id1.value)
            Label:
                text:  str(round(slider_id1.value, 1)) + ' x Beer'
                color: 0,0,0,1
        GridLayout:
            id: Grid1
            cols: 10
            rows: 1

        # Wine
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 0.5
                max: 10
                on_value: root.addwine(slider_id2.value)
            Label:
                text:  str(round(slider_id2.value, 1)) + ' x Wine'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 10
            rows: 1

        # Shots
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addshot(slider_id3.value)
            Label:
                text:  str(round(slider_id3.value, 1)) + ' x Shot'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1

        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
                    text: 'exit'
                    on_press: app.get_running_app().stop()
                Button:
                    text: 'X'
                    on_press: root.manager.current = 'drink'
                Button:
                    text: '>'
                    on_press: root.manager.current = 'destroy'

################################################################################################
# Screen for adding the non-drinkable record
# todo: add food and stress
<DestroyScreen>:
    grid: Grid
	grid2: Grid2
	grid3: Grid3
	tiredranking: tiredranking
	stressranking: stressranking

    MyBoxLayout:
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'icon.png'
            HeaderLabel:
                text: 'Yuck...And how do you feel today?'

        # Cigarette slider
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id
                min: 0
                step: 1
                max: 30
                on_value: root.addcigarette(slider_id.value)
            Label:
                text: str(round(slider_id.value, 0)) + ' x cigarettes'
                color: 0,0,0,1
        GridLayout:
            id: Grid
            cols: 30
            rows: 1

		# Tired
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 1
                max: 10
                on_value: root.addtired(slider_id2.value)
            Label:
                id: tiredranking
                text: 'tired?'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 10
            rows: 1

		# Stress
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addstress(slider_id3.value)
            Label:
                id: stressranking
                text: 'Stress?'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1


       

        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
                    text: '<'
                    on_press: root.manager.current = 'drink'
                Button:
                    text: 'X'
                    on_press: root.manager.current = 'drink'
                Button:
                    text: '>'
                    on_press: root.manager.current = 'heal'

################################################################################################
# Screen for adding the feeling better stuff
<HealScreen>:
    grid: Grid
    grid2: Grid2
    grid3: Grid3
    foodranking: foodranking

    MyBoxLayout:
        GridLayout:
            cols: 2
            rows: 1
            HeaderImage:
                source: 'icon.png'
            HeaderLabel:
                text: 'Tried some countermeasures?'

        # water slider
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id1
                min: 0
                step: 1
                max: 5
                on_value: root.addwater(slider_id1.value)
            Label:
                text: str(round(slider_id1.value, 0)) + ' x glass of water'
                color: 0,0,0,1
        GridLayout:
            id: Grid
            cols: 30
            rows: 1


        # Sleep
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id2
                min: 0
                step: 0.5
                max: 12
                on_value: root.addsleep(slider_id2.value)
            Label:
                text: str(round(slider_id2.value, 1))+ ' hours of sleep'
                color: 0,0,0,1
        GridLayout:
            id: Grid2
            cols: 12
            rows: 1

        # Food
        GridLayout:
            cols: 2
            rows: 1
            Slider:
                id: slider_id3
                min: 0
                step: 1
                max: 10
                on_value: root.addfood(slider_id3.value)
            Label:
                id: foodranking
                text: 'Food?'
                color: 0,0,0,1
        GridLayout:
            id: Grid3
            cols: 10
            rows: 1

        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 3
                rows: 1
                Button:
                    text: '<'
                    on_press: root.manager.current = 'destroy'
                Button:
                    text: 'X'
                    on_press: root.manager.current = 'drink'
                Button:
                    text: '>'
                    on_press: root.ftp_transfer()

################################################################################################
# Navigation page for going to the presented results

<ResultScreen>:
    grid: Grid
    MyBoxLayout:
        GridLayout:
            id: Grid
            cols: 1
            rows: 2
            Button:
                text: 'Result'
                on_press: root.manager.current = 'graph'
            Button:
                text: 'Map'
                on_press: root.manager.current = 'map'

################################################################################################
# map of schlukniks

<MapScreen>:
    MapView:
        id: map
        lat: app.lat
        lon: app.lon
        zoom: 13
        map_source: MapSource(sys.argv[1], attribution="") if len(sys.argv) > 1 else "osm"

    # Navigation Bar
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        size_hint: .2, .2
        GridLayout:
            cols: 2
            rows: 1
            Button:
                text: '<'
                on_press: root.manager.current = 'result'
            Button:
                text: 'exit'
                on_press: app.get_running_app().stop()

################################################################################################
# settings page
# todo: add mandatory first time configuration -> stored as .json; smoker? size? weight? boy/girl?

<SettingsScreen>:
    MyBoxLayout:
        AnchorLayout:
            anchor_x: 'right'
            anchor_y: 'bottom'
            BoxLayout:
                orientation: 'horizontal'
                size_hint: .3, .3
                Button:
                    text: 'Back'
                    on_press: root.manager.current = 'drink'

################################################################################################
# hangover transient screen
# add meaningul computation depending on the input variables

<GraphScreen>:
    grid: Grid
    GridLayout:
        id:Grid
        cols: 1
        rows: 2
        # Navigation Bar
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            GridLayout:
                cols: 2
                rows: 1
                size_hint: .2, .2
                Button:
                    text: '<'
                    on_press: root.manager.current = 'result'
                Button:
                    text: 'exit'
                    on_press: app.get_running_app().stop()